<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>이벤트 프로토타입</title>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/ScrollMagic.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.7/plugins/debug.addIndicators.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/plugins/animation.gsap.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;500;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css?t=<? echo time() ?>">
</head>

<body>

    <div class="top-1">
        <div class="book" id="animate1">
            <div class="msg">
                <img src="./asset/book_msg.svg" alt="">
                <div class="symbol">
                    <div class="front face">
                        <img src="./asset/symbol.svg" alt="">
                    </div>
                    <div class="back face">
                        <img src="./asset/symbol_line.svg" alt="">
                    </div>
                </div>
            </div>
            <img class="book_bg" src="./asset/book.png" alt="">
        </div>
        <div id="trigger1"></div>
    </div>

    <div class="top-2">
        <div id="trigger2"></div>
        <div class="line">
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="252" height="480">
                <path id="word"
                    style="stroke-linecap: round; stroke-linejoin: round; stroke-dasharray: 1009.23px; stroke-dashoffset: 1009.23px;"
                    fill="none" stroke="#000000" stroke-width="5" d="M132.88 397.999C186.898 395.442 224.08 373.482 243.403 340.997C250.073 329.783 254.608 317.327 256.974 304H255.958C253.603 317.152 249.118 329.434 242.544 340.486C223.428 372.623 186.589 394.458 132.822 397.001L132.812 397.001L132.801 397.002L131.969 397.077C107.963 399.243 71.3442 402.548 43.8071 410.942C29.8909 415.184 18.2009 420.752 11.6531 428.206C8.36851 431.945 6.36859 436.169 6.04613 440.937C5.72399 445.7 7.07945 450.953 10.4124 456.749C13.5971 462.288 19.2007 470.065 24.034 475.524C26.4413 478.243 28.6976 480.434 30.3899 481.468C30.817 481.729 31.2272 481.928 31.6097 482.04C31.9893 482.151 32.3813 482.188 32.744 482.071C33.5391 481.816 33.824 480.988 33.8457 480.011L32.846 479.989C32.826 480.887 32.5744 481.075 32.4379 481.119C32.3348 481.152 32.1622 481.16 31.8908 481.08C31.6224 481.002 31.2953 480.849 30.9112 480.614C29.3587 479.666 27.188 477.578 24.7828 474.862C19.9912 469.449 14.428 461.727 11.2793 456.251C8.01693 450.577 6.73842 445.52 7.04385 441.004C7.34897 436.493 9.23818 432.47 12.4044 428.866C18.7585 421.632 30.2173 416.13 44.0987 411.899C71.5359 403.535 108.073 400.238 132.104 398.069L132.869 397.999L132.88 397.999Z"></path>
                <path id="dot"
                    style="stroke-linecap: round; stroke-linejoin: round; stroke-dasharray: 44.2974px; stroke-dashoffset: 44.2974px;"
                    fill="none" stroke="#000000" stroke-width="5"
                    d="M10 2.11516C18.5382 15.11 29.4279 26.4076 42.0633 35.4073L42.0749 35.4153C88.7622 66.7372 133.572 97.5895 169.788 128.484C206.012 159.386 233.582 190.285 245.852 221.682C257.161 250.62 260.426 278.895 255.93 304H256.946C261.432 278.73 258.121 250.327 246.783 221.318C234.42 189.684 206.693 158.653 170.437 127.723C134.173 96.7877 89.3201 65.9074 42.6378 34.5888C30.1056 25.6615 19.3046 14.4553 10.8357 1.56604L10 2.11516Z">
                </path>
            </svg>
        </div>
        <div class="title">
            <span>새롭게 찾아온 밀리뷰어</span>
            독서의<br>
            <b>미래</b>를<br>
            만들다
            <div class="astro">
                <img src="./asset/astro.png" alt="">
            </div>
        </div>
    </div>

    <script>
        var controller = new ScrollMagic.Controller();

        var scene_symbol = new ScrollMagic.Scene({
            triggerElement: ".top-2", offset: -800
        })
            .setClassToggle(".symbol", "is-flipped")
            .addIndicators({ name: "scene_symbol" })
            .addTo(controller);

        var scene_book = new ScrollMagic.Scene({
            triggerHook: .2, duration: 1000, offset: 10
        })
            .setPin(".book")
            .setTween("#animate1", 1, {
                scale: 10,
                x: "-268%",
                y: "50%",
            })
            // .addIndicators({ name: "1 (duration: 0)" })
            .addTo(controller);

        var scene_bookbg = new ScrollMagic.Scene({
            triggerElement: ".top-2", duration: 100, offset: -800,
        })
            .setTween(".book_bg", 1, {
                opacity: 0
            })
            // .addIndicators({ name: "scene_bookbg" })
            .addTo(controller);

        var scene_msg = new ScrollMagic.Scene({
            triggerElement: ".top-2", duration: 200, offset: -800
        })
            .setTween(".msg > img", 1, {
                opacity: 0
            })
            // .addIndicators({ name: "scene_msg" })
            .addTo(controller);

        function pathPrepare($el) {
            var lineLength = $el[0].getTotalLength();
            $el.css("stroke-dasharray", lineLength);
            $el.css("stroke-dashoffset", lineLength);
        }

        var $line1 = $("path#word");
        var $line2 = $("path#dot");

        // prepare SVG
        pathPrepare($line1);
        pathPrepare($line2);

        // build tween
        var tween = new TimelineMax()
            .add(TweenMax.to($line2, 0.9, { strokeDashoffset: 0, ease: Linear.easeNone }))  // draw dot for 0.1
            .add(TweenMax.to($line1, 0.9, { strokeDashoffset: 0, ease: Linear.easeNone })) // draw word for 0.9
            .add(TweenMax.to("path", 1, { stroke: "#FFEB60", ease: Linear.easeNone }), 0); // change color during the whole thing

        // build scene
        var scene = new ScrollMagic.Scene({ triggerElement: "#trigger2", duration: 200, tweenChanges: true })
            .setTween(tween)
            .addIndicators() // add indicators (requires plugin)
            .addTo(controller);

    </script>


</body>

</html>